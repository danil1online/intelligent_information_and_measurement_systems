# –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ —É–∫–∞–∑–∞–Ω–∏—è –∫ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ1 
**–¢–µ–º–∞:** –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. 4 —á–∞—Å–∞  

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã  
–ò–∑—É—á–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:  
- Confusion Matrix  
- Accuracy  
- Recall  
- Precision  
- F1-Score  

---

## üìå –ó–∞–¥–∞—á–∏  
- –ò–∑—É—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ —Å–º—ã—Å–ª Confusion Matrix  
- –ü–æ–Ω—è—Ç—å –º–µ—Ç—Ä–∏–∫—É Accuracy  
- –ò–∑—É—á–∏—Ç—å Recall  
- –ò–∑—É—á–∏—Ç—å Precision  
- –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å F1-Score  

---

## üìÅ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì Python 3.10.
- –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  -  [scikit-learn](https://scikit-learn.org/),
  -  [matplotlib](https://matplotlib.org/),
  -  [PyTorch (torch, torchvision)](https://pytorch.org/).
  
### üìÅ –°–≤–µ–¥–µ–Ω–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö  
- [**MNIST**](https://www.kaggle.com/datasets/hojjatk/mnist-dataset): 60 000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ü–∏—Ñ—Ä (28√ó28), 10 –∫–ª–∞—Å—Å–æ–≤  
- [**Fashion-MNIST**](https://www.kaggle.com/datasets/zalando-research/fashionmnist): 70 000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ–¥–µ–∂–¥—ã (28√ó28, –≥—Ä–∞–¥–∞—Ü–∏–µ —Å–µ—Ä–æ–≥–æ), 10 –∫–ª–∞—Å—Å–æ–≤ (—Ñ—É—Ç–±–æ–ª–∫–∏, –±—Ä—é–∫–∏, –æ–±—É–≤—å –∏ —Ç. –¥.), –∞–Ω–∞–ª–æ–≥ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ MNIST, –Ω–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã 
- [**CIFAR-10**](https://www.kaggle.com/c/cifar-10/): 60 000 —Ü–≤–µ—Ç–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (32√ó32), 10 –∫–ª–∞—Å—Å–æ–≤ (—Å–∞–º–æ–ª—ë—Ç—ã, –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –ø—Ç–∏—Ü—ã –∏ —Ç. –¥.), 50 000 –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, 10 000 –¥–ª—è —Ç–µ—Å—Ç–∞

---

## üìö –ö—Ä–∞—Ç–∫–∞—è —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è  

### Confusion Matrix  
|               | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ: –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ |
|---------------|----------------------------|-----------------------------|
| –ò—Å—Ç–∏–Ω–Ω–æ–µ: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ (TP) | TP | FN |
| –ò—Å—Ç–∏–Ω–Ω–æ–µ: –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ (TN) | FP | TN |

### –ú–µ—Ç—Ä–∏–∫–∏  
- **Accuracy**:  
  

$$
  Accuracy = \frac{TP + TN}{TP + FP + FN + TN}
$$



- **Recall**:  
  

$$
  Recall = \frac{TP}{TP + FN}
$$



- **Precision**:  
  

$$
  Precision = \frac{TP}{TP + FP}
$$



- **F1-Score**:  
  

$$
  F1 = 2 \cdot \frac{Precision \cdot Recall}{Precision + Recall}
$$


- **ROC-–∫—Ä–∏–≤–∞—è –∏ AUC**

ROC-–∫—Ä–∏–≤–∞—è (Receiver Operating Characteristic) –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–ª–∏ (TPR) –æ—Ç –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–ª–∏ (FPR) –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ —Ä–µ—à–µ–Ω–∏—è.

TPR (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, Recall) —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫


$$
  TPR = \frac{TP}{TP + FN}
$$


FPR –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫


$$
  FPR = \frac{FP}{FP + TN}
$$


AUC (Area Under Curve) ‚Äî –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π. –ó–Ω–∞—á–µ–Ω–∏–µ AUC –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –æ—Ç 0.5 (—Å–ª—É—á–∞–π–Ω–∞—è –º–æ–¥–µ–ª—å) –¥–æ 1.0 (–∏–¥–µ–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å) –æ—Ç—Ä–∞–∂–∞–µ—Ç –æ–±—â–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–æ—Ä–æ–≥–∞.

- **Balanced Accuracy –∏ Cohen‚Äôs Kappa**

Balanced Accuracy ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Ç—ã –ø–æ –∫–ª–∞—Å—Å–∞–º. –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:


$$
  BalancedAccuracy = \frac{1}{2} \cdot ( \frac{TP}{TP + FN} + \frac{TN}{TN + FP} )
$$


Cohen‚Äôs Kappa –∏–∑–º–µ—Ä—è–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏ –∏—Å—Ç–∏–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ:


$$
  k = \frac{p_{0} - p_{e}}{1 - p_{e}},
$$


–≥–¥–µ p<sub>0</sub> -- –Ω–∞–±–ª—é–¥–∞–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å (Accuracy), –∞ p<sub>e</sub> -- –æ–∂–∏–¥–∞–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω–æ–º —É–≥–∞–¥—ã–≤–∞–Ω–∏–∏.

---

## üå≥ –û—Å–Ω–æ–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
1. [**SVM (Support Vector Machine)**](https://scikit-learn.org/stable/modules/svm.html):
- –ú–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —è–¥—Ä–∞ (–ª–∏–Ω–µ–π–Ω–æ–µ, RBF –∏ –¥—Ä.)
2. [**RandomForest**](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html):
- –ê–Ω—Å–∞–º–±–ª—å –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π
- –£—Å—Ä–µ–¥–Ω—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é
3. [**–ü—Ä–æ—Å—Ç–µ–π—à–∞—è CNN (Convolutional Neural Network)**](https://www.datacamp.com/tutorial/pytorch-cnn-tutorial):
- –°–ª–æ–π —Å–≤—ë—Ä—Ç–∫–∏ + ReLU + –ø—É–ª–∏–Ω–≥
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö –±–ª–æ–∫–æ–≤ + –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π
- –í PyTorch: *torch.nn.Conv2d*, *torch.nn.MaxPool2d*, *torch.nn.Linear* 

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã  

### –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ [Jupyter-Hub](https://jupyter.org/hub) –ø–æ –∞–¥—Ä–µ—Å—É [Jupyter-Hub-–ò–ò–°–¢-–ù–ü–ò](http://195.133.13.56:8000/)

![–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](../images/autorization.png)

### –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å–∏–º–≤–æ–ª–æ–º **+**

![–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏](../images/new_window_create.png)

### –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ -- Terminal 

![–°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ Terminal](../images/terminal_window_create.png)

### –†–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∏–¥–∞

![–í–ª–∞–¥–∫–∞ Terminal](../images/basic_window.png)


### –í–≤–µ—Å—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (–∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –æ—Ç–¥–µ–ª—å–Ω–æ):

```bash
mkdir image_classification_metrics
cd image_classification_metrics
python3.10 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
pip install scikit-learn matplotlib
```

---
## üß™ –ü—Ä–∏–º–µ—Ä—ã

### üß™ –ü—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ *nano*

```bash

nano lab1_1.py
```

–í—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç:

```python
#!/usr/bin/env python3
import torch
from torchvision import datasets, transforms
from torch.utils.data import DataLoader
from sklearn.metrics import confusion_matrix, classification_report, accuracy_score
import matplotlib.pyplot as plt
import numpy as np

# 1. –ó–∞–≥—Ä—É–∑–∫–∞ MNIST
transform = transforms.Compose([transforms.ToTensor()])
train_ds = datasets.MNIST('.', download=True, train=False, transform=transform)
loader = DataLoader(train_ds, batch_size=256, shuffle=False)

# 2. –ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å: —Å–ª—É—á–∞–π–Ω—ã–µ –º–µ—Ç–∫–∏
y_true, y_pred = [], []
for images, labels in loader:
    y_true.extend(labels.numpy())
    # –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
    y_pred.extend(np.random.randint(0, 10, size=labels.shape))

y_true = np.array(y_true)
y_pred = np.array(y_pred)

# 3. –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫
acc = accuracy_score(y_true, y_pred)
report = classification_report(y_true, y_pred, digits=4)
cm = confusion_matrix(y_true, y_pred)

print(f"Accuracy: {acc:.4f}")
print(report)

# 4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫
plt.figure(figsize=(8, 6))
plt.imshow(cm, interpolation='nearest', cmap='Blues')
plt.title("Confusion Matrix")
plt.colorbar()
plt.xlabel("–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å")
plt.ylabel("–ò—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å")
plt.savefig("confusion_matrix.png", dpi=150)
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç `Ctrl+X` - `Enter` –∏ –≤—ã–π—Ç–∏ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ *nano* `Ctrl+O`

–ó–∞–ø—É—Å–∫ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:

```bash

python3 lab1_1.py

```

–£–±–µ–¥–∏—Ç—å—Å—è –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º Confusion Matrix. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å –æ–∫–Ω–∞:
- –î–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∏–º–µ–Ω–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–∞—Ç–∞–ª–æ–≥ `image_classification_metrics`

![–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è lanb1_1.py](../images/result_lab1_1.png)

- –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª `confusion_matrix.png` –¥–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ–º

![Confusion_Matrix lanb1_1.py](../images/confusion_matrix_lab1_1.png)


### üìå –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã #1
1. –ó–∞–º–µ–Ω–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö –º–µ—Ç–æ–∫ –Ω–∞ –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é –∏–∑ sklearn.linear_model.LogisticRegression –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –≤ –≤–µ–∫—Ç–æ—Ä 784-—Ö).
2. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

```python
# –ó–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è
from sklearn.linear_model import LogisticRegression

# ... –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ...
model = LogisticRegression(max_iter=200)
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

# —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ –≤—ã–≤–µ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏
```


### üß™ –ü—Ä–∏–º–µ—Ä 2. SVM + CIFAR-10 + ROC-–∫—Ä–∏–≤–∞—è –∏ AUC

–°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª `lab1_2.py` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```python
#!/usr/bin/env python3
import numpy as np
from sklearn.svm import SVC
from sklearn.metrics import roc_curve, auc
from sklearn.preprocessing import label_binarize
from torchvision.datasets import CIFAR10
from torchvision.transforms import ToTensor

# –ó–∞–≥—Ä—É–∑–∫–∞ CIFAR-10
ds = CIFAR10('.', train=False, download=True, transform=ToTensor())
X = np.array([img.numpy().reshape(-1) for img, _ in ds])
y = np.array([label for _, label in ds])

# –ë–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–∫ (One-vs-Rest)
y_bin = label_binarize(y, classes=range(10))

# –û–±—É—á–µ–Ω–∏–µ SVM —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–º–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏
model = SVC(kernel='linear', probability=True, random_state=42)
model.fit(X, y)

# –î–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞—Å—Å 0)
probs = model.predict_proba(X)[:, 0]
fpr, tpr, _ = roc_curve(y_bin[:, 0], probs)
roc_auc = auc(fpr, tpr)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
import matplotlib.pyplot as plt
plt.figure()
plt.plot(fpr, tpr, label=f'AUC = {roc_auc:.3f}')
plt.plot([0,1], [0,1], 'k--')
plt.xlabel('FPR')
plt.ylabel('TPR')
plt.title('ROC-–∫—Ä–∏–≤–∞—è –¥–ª—è –∫–ª–∞—Å—Å–∞ 0')
plt.legend(loc='lower right')
plt.savefig('svm_cifar10_roc.png', dpi=150)
```

–£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞.


### üìå –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã #2
1. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ ROC-–∫—Ä–∏–≤—ã–µ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ AUC –¥–ª—è —Ç—Ä—ë—Ö –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ CIFAR-10.
2. –°—Ä–∞–≤–Ω–∏—Ç–µ, –∫–∞–∫–∏–µ –∫–ª–∞—Å—Å—ã –º–æ–¥–µ–ª—å –æ—Ç–¥–µ–ª—è–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ.


### üß™ –ü—Ä–∏–º–µ—Ä 3. RandomForest + Fashion-MNIST + Balanced Accuracy –∏ Cohen‚Äôs Kappa

–°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª `lab1_3.py` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```python
#!/usr/bin/env python3
import numpy as np
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import balanced_accuracy_score, cohen_kappa_score
from torchvision.datasets import FashionMNIST
from torchvision.transforms import ToTensor

# –ó–∞–≥—Ä—É–∑–∫–∞ Fashion-MNIST
ds = FashionMNIST('.', train=False, download=True, transform=ToTensor())
X = np.array([img.numpy().reshape(-1) for img, _ in ds])
y = np.array([label for _, label in ds])

# –û–±—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞
rf = RandomForestClassifier(n_estimators=100, random_state=0)
rf.fit(X, y)
y_pred = rf.predict(X)

# –ú–µ—Ç—Ä–∏–∫–∏
bal_acc = balanced_accuracy_score(y, y_pred)
kappa = cohen_kappa_score(y, y_pred)
print(f"Balanced Accuracy: {bal_acc:.4f}")
print(f"Cohen's Kappa: {kappa:.4f}")
```


### üìå –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã #3
1. –ò–∑–º–µ–Ω–∏—Ç–µ —á–∏—Å–ª–æ –¥–µ—Ä–µ–≤—å–µ–≤ (n_{estimators}) –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ, –∫–∞–∫ –º–µ–Ω—è—é—Ç—Å—è Balanced Accuracy –∏ Œ∫.
2. –û—Ü–µ–Ω–∏—Ç–µ, –ø—Ä–∏ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–µ—Ä–µ–≤—å–µ–≤ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ—Ç—Ä–∏–∫.


### üß™ –ü—Ä–∏–º–µ—Ä 4. –ü—Ä–æ—Å—Ç–∞—è CNN + CIFAR-10 + –≤–µ—Å—å –Ω–∞–±–æ—Ä –º–µ—Ç—Ä–∏–∫

–°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–∞–π–ª `lab1_4.py` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```python
#!/usr/bin/env python3
import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import DataLoader
from torchvision import transforms, datasets
import numpy as np
from sklearn.metrics import (
    confusion_matrix, accuracy_score,
    precision_recall_fscore_support,
    balanced_accuracy_score, cohen_kappa_score,
    roc_curve, auc
)
import matplotlib.pyplot as plt

# 1. –°–µ—Ç—å
class SimpleCNN(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv_block = nn.Sequential(
            nn.Conv2d(3, 16, 3, padding=1), nn.ReLU(),
            nn.MaxPool2d(2),
            nn.Conv2d(16, 32, 3, padding=1), nn.ReLU(),
            nn.MaxPool2d(2)
        )
        self.fc = nn.Linear(32*8*8, 10)
    def forward(self, x):
        x = self.conv_block(x)
        x = x.view(x.size(0), -1)
        return self.fc(x)

# 2. –î–∞–Ω–Ω—ã–µ
transform = transforms.Compose([transforms.ToTensor()])
train_ds = datasets.CIFAR10('.', train=True, download=True, transform=transform)
test_ds  = datasets.CIFAR10('.', train=False, download=False, transform=transform)
train_loader = DataLoader(train_ds, batch_size=128, shuffle=True)
test_loader  = DataLoader(test_ds,  batch_size=256, shuffle=False)

# 3. –û–±—É—á–µ–Ω–∏–µ (2 —ç–ø–æ—Ö–∏ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞)
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = SimpleCNN()
model.to(device)
criterion = nn.CrossEntropyLoss()
opt = optim.Adam(model.parameters(), lr=1e-3)
num_epochs = 3
for epoch in range(num_epochs):
  model.train()
  running_loss = 0.0
  for imgs, labels in train_loader:
      imgs, labels = imgs.to(device), labels.to(device)
      pred = model(imgs)
      loss = criterion(pred, labels)
      opt.zero_grad(); loss.backward(); opt.step()
      running_loss += loss.item()
  avg_loss = running_loss / len(train_loader)
  print(f"Epoch {epoch+1}/{num_epochs} ‚Äî Loss: {avg_loss:.4f}")

# 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
model.eval()
y_true, y_pred, y_prob = [], [], []
with torch.no_grad():
    for imgs, labels in test_loader:
        imgs = imgs.to(device)
        logits = model(imgs)
        probs = nn.Softmax(dim=1)(logits).cpu().numpy()
        pred  = np.argmax(probs, axis=1)
        y_true.extend(labels.numpy())
        y_pred.extend(pred)
        y_prob.extend(probs)

y_true = np.array(y_true)
y_pred = np.array(y_pred)
y_prob = np.array(y_prob)

# 5. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
acc   = accuracy_score(y_true, y_pred)
prec, rec, f1, _ = precision_recall_fscore_support(y_true, y_pred, average='macro')
bal_acc = balanced_accuracy_score(y_true, y_pred)
kappa   = cohen_kappa_score(y_true, y_pred)

print(f"Accuracy: {acc:.4f}")
print(f"Precision: {prec:.4f}, Recall: {rec:.4f}, F1-Score: {f1:.4f}")
print(f"Balanced Accuracy: {bal_acc:.4f}")
print(f"Cohen's Kappa: {kappa:.4f}")

# 6. –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
cm = confusion_matrix(y_true, y_pred)
plt.imshow(cm, cmap='Blues')
plt.title("Confusion Matrix")
plt.colorbar()
plt.savefig("cnn_cifar10_cm.png", dpi=150)

# 7. ROC –∏ AUC –¥–ª—è —Ç—Ä—ë—Ö –∫–ª–∞—Å—Å–æ–≤
plt.clf()       # –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ñ–∏–≥—É—Ä—É
plt.close()     # –ó–∞–∫—Ä—ã—Ç—å —Ç–µ–∫—É—â—É—é —Ñ–∏–≥—É—Ä—É
for cls in [0,1,2]:
    fpr, tpr, _ = roc_curve((y_true==cls).astype(int), y_prob[:,cls])
    roc_auc = auc(fpr, tpr)
    plt.plot(fpr, tpr, label=f"Class {cls} (AUC={roc_auc:.2f})")
plt.plot([0,1],[0,1],'k--')
plt.xlabel("FPR"); plt.ylabel("TPR")
plt.title("ROC for CNN")
plt.legend()
plt.savefig("cnn_cifar10_roc_all.png", dpi=150)
```

–£–±–µ–¥–∏—Ç—å—Å—è –≤ –Ω–∞–ª–∏—á–∏–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –≤–∏–¥–µ –≥—Ä–∞—Ñ–∏–∫–∞.


### üìå –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã #4
1. –î–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä—É—é —ç–ø–æ—Ö—É –æ–±—É—á–µ–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ, –∫–∞–∫ –∏–∑–º–µ–Ω—è—Ç—Å—è –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏.
2. –ò–∑–º–µ–Ω–∏—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É CNN (–¥–æ–±–∞–≤—å—Ç–µ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π –∏–ª–∏ –ø–ª–æ—Ç–Ω—ã–π —Å–ª–æ–π) –∏ –æ—Ü–µ–Ω–∏—Ç–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ AUC, Œ∫ –∏ –¥—Ä—É–≥–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏.

---

## üí° –ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–∫–ª—é—á–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã python (–¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–ø–∞—Å—Ç—å –Ω–∞–¥–ø–∏—Å—å (venv) –≤ –Ω–∞—á–∞–ª–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏):

```bash

deactivate

```

---
## –í–æ–ø—Ä–æ—Å—ã
1. –ö–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –º–æ–¥–µ–ª–∏?
2. –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –º–µ—Ç—Ä–∏–∫—É Accuracy –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ª—å–∑—è?
3. –ö–∞–∫ —Å–æ–æ—Ç–Ω–æ—Å—è—Ç—Å—è Precision –∏ Recall –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤?
4. –ü–æ—á–µ–º—É F1-Score –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ Accuracy?
5. –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞ ‚Äú–≥–æ—Ä—è—á–µ–π‚Äù (—Ç–µ–ø–ª–æ–≤–æ–π) –∫–∞—Ä—Ç—ã –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫?
6. –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—Å—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏?
7. –ö–∞–∫–∏–µ –µ—â—ë –º–µ—Ç—Ä–∏–∫–∏ —Å—Ç–æ–∏—Ç –∏–∑—É—á–∏—Ç—å –¥–ª—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏?
8. –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –Ω–∞–∏–±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é —ç–ø–æ—Ö/—Å–ª–æ–µ–≤ –≤ CNN?
9. –ü–æ—á–µ–º—É AUC –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏ –ø—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–º –ø–æ–≤—ã—à–µ–Ω–∏–∏ Accuracy?
10. –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö Balanced Accuracy –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –æ–±—ã—á–Ω–æ–π Accuracy?
11. –ö–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ probability=True –≤ SVM –Ω–∞ —Ä–∞—Å—á—ë—Ç ROC?
12. –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ Œ∫ –±–ª–∏–∑–∫–æ–µ –∫ –Ω—É–ª—é, –∞ —á—Ç–æ ‚Äî –±–ª–∏–∑–∫–æ–µ –∫ –µ–¥–∏–Ω–∏—Ü–µ?
13. –ö–∞–∫–∏–µ –ø—Ä–∏—ë–º—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è Recall –±–µ–∑ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–∞–¥–µ–Ω–∏—è Precision?
14. –ö–∞–∫–∏–µ –µ—â—ë –º–æ–¥–µ–ª–∏ –∏ –¥–∞—Ç–∞—Å–µ—Ç—ã –±—ã–ª–æ –±—ã –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ø—Ä–∞–∫—Ç–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏?

